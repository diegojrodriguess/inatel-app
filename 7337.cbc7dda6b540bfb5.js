"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7337],{7337:(D,u,r)=>{r.r(u),r.d(u,{BooksPageModule:()=>M});var d=r(2881),h=r(4341),s=r(9420),p=r(5207),o=r(1360),k=r(467),v=r(5572),m=r(1633),g=r(9609),b=r(9368),x=r(8806);const C=()=>[1,2,3,4,5];function y(t,a){if(1&t&&(o.qex(0),o.nrm(1,"ion-icon",11),o.bVm()),2&t){const n=a.index,e=o.XpG(2).$implicit;o.R7$(),o.Y8G("name",e.nota>=n+1?"star":e.nota>=n+.5?"star-half":"star-outline")}}function P(t,a){if(1&t){const n=o.RV6();o.j41(0,"ion-item",4)(1,"ion-label")(2,"div",5),o.EFF(3),o.k0s(),o.j41(4,"div",6),o.EFF(5),o.k0s(),o.j41(6,"div",7),o.DNE(7,y,2,1,"ng-container",2),o.j41(8,"span",8),o.EFF(9),o.k0s()(),o.j41(10,"div",9),o.EFF(11),o.k0s()(),o.j41(12,"ion-button",10),o.bIt("click",function(){o.eBV(n);const i=o.XpG().$implicit,l=o.XpG();return o.Njj(l.presentAlert(i))}),o.EFF(13,"Alugar"),o.k0s()()}if(2&t){const n=o.XpG().$implicit;o.R7$(3),o.JRh(n.titulo),o.R7$(2),o.JRh(n.autor),o.R7$(2),o.Y8G("ngForOf",o.lJ4(6,C)),o.R7$(2),o.JRh(n.nota),o.R7$(2),o.Lme(" Dispon\xedvel: ",n.quantidade," ",1===n.quantidade?"unidade":"unidades"," ")}}function B(t,a){if(1&t&&(o.qex(0),o.DNE(1,P,14,7,"ion-item",3),o.bVm()),2&t){const n=a.$implicit;o.R7$(),o.Y8G("ngIf",n.quantidade>0)}}let f=(()=>{var t;class a{constructor(e,i,l,c,_){this.bookRepository=e,this.alertController=i,this.loanRepository=l,this.userRepository=c,this.router=_,this.books=[],this.filteredBooks=this.books,this.user=void 0,this.filteredBooks=this.books,this.user=c.getById(1)}ngOnInit(){this.reloadData(),this.router.events.subscribe(e=>{e instanceof g.wF&&"/books"===this.router.url&&this.reloadData()})}reloadData(){this.books=this.bookRepository.getAll(),this.filteredBooks=this.books}onSearch(e){var i;const l=(null===(i=e.target.value)||void 0===i?void 0:i.toLowerCase())||"";clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.filteredBooks=l?this.books.filter(c=>c.titulo.toLowerCase().includes(l)):this.books},300)}presentAlert(e){var i=this;return(0,k.A)(function*(){yield(yield i.alertController.create({header:"Confirmar Empr\xe9stimo",subHeader:"Prazo de devolu\xe7\xe3o: 14 dias",message:"\n    Multa de R$1,00 por dia em caso de atraso.\n    Voc\xea pode renovar por mais 7 dias.\n  ",buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{const c=new v.F(e,i.user,new Date,new Date((new Date).setDate((new Date).getDate()+14)));i.loanRepository.add(c),e.quantidade--,i.bookRepository.update(e.id,e),i.reloadData(),console.log(`Empr\xe9stimo confirmado para o livro: ${e.titulo}`)}}]})).present()})()}}return(t=a).\u0275fac=function(e){return new(e||t)(o.rXU(b.U),o.rXU(s.hG),o.rXU(x.d),o.rXU(m.G),o.rXU(g.Ix))},t.\u0275cmp=o.VBU({type:t,selectors:[["app-list"]],features:[o.Jv_([m.G])],decls:10,vars:1,consts:[[1,"book-author",2,"margin-top","4px"],["placeholder","Pesquisar livros...",2,"margin-bottom","12px",3,"ionInput"],[4,"ngFor","ngForOf"],["lines","none","class","list-card",4,"ngIf"],["lines","none",1,"list-card"],[1,"book-title"],[1,"book-author"],[1,"book-rating"],[1,"book-rating-value"],[1,"book-available"],["slot","end","color","primary",1,"alugar-btn",3,"click"],[2,"font-size","1.1em",3,"name"]],template:function(e,i){1&e&&(o.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),o.EFF(3,"Lista de Livros"),o.k0s(),o.j41(4,"div",0),o.EFF(5," Encontre seu pr\xf3ximo livro para alugar "),o.k0s()(),o.j41(6,"ion-card-content")(7,"ion-searchbar",1),o.bIt("ionInput",function(c){return i.onSearch(c)}),o.k0s(),o.j41(8,"ion-list"),o.DNE(9,B,2,1,"ng-container",2),o.k0s()()()),2&e&&(o.R7$(9),o.Y8G("ngForOf",i.filteredBooks))},dependencies:[s.bv,s.Jm,s.b_,s.I9,s.ME,s.tN,s.iq,s.uz,s.he,s.nf,s.S1,s.Gw,d.Sq,d.bT],styles:[".list-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:12px;box-shadow:0 2px 8px #0001}.book-title[_ngcontent-%COMP%]{font-weight:700}.book-author[_ngcontent-%COMP%]{font-size:.95em;color:var(--ion-color-medium)}.book-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin:4px 0}.book-rating-value[_ngcontent-%COMP%]{font-size:.95em;color:#555}.book-available[_ngcontent-%COMP%]{font-size:.95em;color:#1976d2}.alugar-btn[_ngcontent-%COMP%]{border-radius:8px}"]}),a})();const F=[{path:"",component:(()=>{var t;class a{constructor(){}ngOnInit(){}}return(t=a).\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.VBU({type:t,selectors:[["app-books"]],standalone:!1,decls:4,vars:0,consts:[["fullscreen","true"],[1,"container"],[1,"cards"]],template:function(e,i){1&e&&(o.j41(0,"ion-content",0)(1,"div",1)(2,"div",2),o.nrm(3,"app-list"),o.k0s()()())},dependencies:[s.W9,f],styles:[".container[_ngcontent-%COMP%]{width:100%;max-width:414px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:16px;min-height:100vh}.cards[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding:16px;min-height:0}"]}),a})()}];let R=(()=>{var t;class a{}return(t=a).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[p.iI.forChild(F),p.iI]}),a})(),M=(()=>{var t;class a{}return(t=a).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[d.MD,h.YN,s.bv,R,f]}),a})()}}]);