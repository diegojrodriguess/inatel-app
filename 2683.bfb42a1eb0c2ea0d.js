"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2683],{2683:(T,g,c)=>{c.r(g),c.d(g,{ProfilePageModule:()=>S});var d=c(2881),p=c(4341),r=c(9420),f=c(5207),n=c(1360),v=c(1633);let _=(()=>{var t;class i{constructor(e){this.userRepository=e,this.user=void 0,this.user=e.getById(1)}ngOnInit(){}}return(t=i).\u0275fac=function(e){return new(e||t)(n.rXU(v.G))},t.\u0275cmp=n.VBU({type:t,selectors:[["app-card"]],features:[n.Jv_([v.G])],decls:15,vars:3,consts:[[1,"profile-card"],[1,"profile-info"],[1,"profile-avatar"],["name","person-circle",1,"avatar-icon"],[1,"user-details"],[1,"user-name"],[1,"user-email"],[1,"course-name"]],template:function(e,a){1&e&&(n.j41(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-title"),n.EFF(3,"Meu Perfil"),n.k0s()(),n.j41(4,"ion-card-content")(5,"div",1)(6,"ion-avatar",2),n.nrm(7,"ion-icon",3),n.k0s(),n.j41(8,"div",4)(9,"div",5),n.EFF(10),n.k0s(),n.j41(11,"div",6),n.EFF(12),n.k0s(),n.j41(13,"span",7),n.EFF(14),n.k0s()()()()()),2&e&&(n.R7$(10),n.JRh(null==a.user?null:a.user.nome),n.R7$(2),n.JRh(null==a.user?null:a.user.email),n.R7$(2),n.JRh(null==a.user?null:a.user.curso))},dependencies:[r.bv,r.mC,r.b_,r.I9,r.ME,r.tN,r.iq],styles:[".profile-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.profile-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:12px;flex-wrap:wrap}@media (max-width: 480px){.profile-info[_ngcontent-%COMP%]{justify-content:center;text-align:center}}.profile-avatar[_ngcontent-%COMP%]{width:56px;height:56px;min-width:56px}.avatar-icon[_ngcontent-%COMP%]{font-size:56px;color:#1976d2}.user-details[_ngcontent-%COMP%]{flex:1;min-width:200px}@media (max-width: 480px){.user-details[_ngcontent-%COMP%]{width:100%}}.user-name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.user-email[_ngcontent-%COMP%]{font-size:.95em;color:#888}.course-name[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}"]}),i})();var u=c(467),m=c(9609),C=c(8806),h=c(9368);function M(t,i){if(1&t&&(n.j41(0,"div",15)(1,"span",16),n.EFF(2),n.k0s(),n.j41(3,"span",17),n.EFF(4),n.k0s()()),2&t){const o=n.XpG().$implicit;n.R7$(2),n.SpI(" Atrasado (",o.multa," dias) "),n.R7$(2),n.SpI(" Multa: R$",o.multa,",00 ")}}function P(t,i){if(1&t&&(n.j41(0,"span",18),n.EFF(1),n.k0s()),2&t){const o=n.XpG().$implicit,e=n.XpG();n.R7$(),n.SpI(" ",e.diasRestantes(o)," dias restantes ")}}function b(t,i){if(1&t){const o=n.RV6();n.j41(0,"ion-button",19),n.bIt("click",function(){n.eBV(o);const a=n.XpG().$implicit,l=n.XpG();return n.Njj(l.renovarEmprestimo(a))}),n.EFF(1,"Renovar"),n.k0s()}}function y(t,i){1&t&&n.nrm(0,"div",20)}function R(t,i){if(1&t){const o=n.RV6();n.j41(0,"div",4)(1,"div",5),n.EFF(2),n.k0s(),n.j41(3,"div",6),n.EFF(4),n.k0s(),n.j41(5,"div",7)(6,"div",8),n.nrm(7,"ion-icon",9),n.EFF(8),n.nI1(9,"date"),n.k0s(),n.j41(10,"div",8),n.nrm(11,"ion-icon",9),n.EFF(12),n.nI1(13,"date"),n.k0s()(),n.DNE(14,M,5,2,"div",10)(15,P,2,1,"ng-template",null,0,n.C5r),n.j41(17,"div",11),n.DNE(18,b,2,0,"ion-button",12),n.j41(19,"ion-button",13),n.bIt("click",function(){const a=n.eBV(o).$implicit,l=n.XpG();return n.Njj(l.devolverLivro(a))}),n.EFF(20,"Devolver"),n.k0s()(),n.DNE(21,y,1,0,"div",14),n.k0s()}if(2&t){const o=i.$implicit,e=i.last,a=n.sdS(16);n.R7$(2),n.JRh(o.book.titulo),n.R7$(2),n.JRh(o.book.autor),n.R7$(4),n.SpI(" Emprestado: ",n.i5U(9,8,o.dataEmprestimo,"dd/MM/yyyy")," "),n.R7$(4),n.SpI(" Devolu\xe7\xe3o: ",n.i5U(13,11,o.dataDevolucao,"dd/MM/yyyy")," "),n.R7$(2),n.Y8G("ngIf",o.multa>0)("ngIfElse",a),n.R7$(4),n.Y8G("ngIf",0===o.multa),n.R7$(3),n.Y8G("ngIf",!e)}}let k=(()=>{var t;class i{constructor(e,a,l,s){this.loanRepository=e,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(e=>{e instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getActiveLoansByUserId(1)}diasRestantes(e){const a=new Date,l=e.dataDevolucao.getTime()-a.getTime();return Math.max(Math.ceil(l/864e5),0)}renovarEmprestimo(e){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Renova\xe7\xe3o",message:`\n      Tem certeza que deseja renovar o empr\xe9stimo do livro "${e.book.titulo}" por mais 7 dias?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{e.dataEmprestimo=new Date(e.dataEmprestimo.getTime()+6048e5),e.dataDevolucao=new Date(e.dataDevolucao.getTime()+6048e5),a.loanRepository.update(e.id,e),a.reloadData()}}]})).present()})()}devolverLivro(e){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Devolu\xe7\xe3o",message:`\n      Tem certeza que deseja devolver o livro "${e.book.titulo}"?\n      ${e.multa>0?`\n\nMulta pendente: R$${e.multa},00`:""}\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{a.loanRepository.devolverLivro(e.id);const s=e.book;s.quantidade++,a.bookRepository.update(s.id,s),a.reloadData()}}]})).present()})()}}return(t=i).\u0275fac=function(e){return new(e||t)(n.rXU(C.d),n.rXU(h.U),n.rXU(m.Ix),n.rXU(r.hG))},t.\u0275cmp=n.VBU({type:t,selectors:[["app-loans"]],decls:7,vars:1,consts:[["prazoRestante",""],[1,"loans-card"],[1,"loans-container"],["class","loan-item",4,"ngFor","ngForOf"],[1,"loan-item"],[1,"book-title"],[1,"book-author"],[1,"loan-dates"],[1,"date-item"],["name","calendar-outline",1,"date-icon"],["class","status-container",4,"ngIf","ngIfElse"],[1,"actions-container"],["size","small","color","primary","fill","solid","class","action-button",3,"click",4,"ngIf"],["size","small","color","success","fill","solid",1,"action-button",3,"click"],["class","divider",4,"ngIf"],[1,"status-container"],[1,"status-badge","status-late"],[1,"fine-amount"],[1,"status-badge","status-remaining"],["size","small","color","primary","fill","solid",1,"action-button",3,"click"],[1,"divider"]],template:function(e,a){1&e&&(n.j41(0,"ion-card",1)(1,"ion-card-header")(2,"ion-card-title"),n.EFF(3,"Meus Empr\xe9stimos"),n.k0s()(),n.j41(4,"ion-card-content")(5,"div",2),n.DNE(6,R,22,14,"div",3),n.k0s()()()),2&e&&(n.R7$(6),n.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,d.Sq,d.bT,d.MD,d.vh],styles:[".loans-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.loans-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.loan-item[_ngcontent-%COMP%]{padding:12px;border-radius:8px}.book-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.book-author[_ngcontent-%COMP%]{color:#666;font-size:.95em;margin-bottom:12px}.loan-dates[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin:12px 0}.date-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.95em}.date-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:1.2em}.status-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin:12px 0}.status-badge[_ngcontent-%COMP%]{border-radius:8px;padding:4px 12px;font-size:.95em;display:inline-block}.status-late[_ngcontent-%COMP%]{background:#e53935;color:#fff}.status-remaining[_ngcontent-%COMP%]{background:#ffd600;color:#333}.fine-amount[_ngcontent-%COMP%]{color:#e53935;font-weight:700}.actions-container[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}.action-button[_ngcontent-%COMP%]{flex:1;min-width:120px}.divider[_ngcontent-%COMP%]{height:12px}@media (max-width: 414px){.loans-card[_ngcontent-%COMP%]{margin:8px;width:calc(100% - 16px)}.loan-item[_ngcontent-%COMP%]{padding:8px}.book-title[_ngcontent-%COMP%]{font-size:1em}.book-author[_ngcontent-%COMP%], .date-item[_ngcontent-%COMP%]{font-size:.9em}.status-badge[_ngcontent-%COMP%]{font-size:.9em;padding:3px 10px}.actions-container[_ngcontent-%COMP%]{flex-direction:column}.action-button[_ngcontent-%COMP%]{width:100%}}"]}),i})();var O=c(5572);function F(t,i){if(1&t&&(n.j41(0,"div",13)(1,"span",14),n.EFF(2),n.k0s(),n.j41(3,"span",15),n.EFF(4),n.k0s()()),2&t){const o=n.XpG().$implicit;n.R7$(2),n.SpI(" Multa: R$",o.multaCalculada,",00 "),n.R7$(2),n.SpI(" ",o.multaPaga?"Pago":"Pendente"," ")}}function E(t,i){1&t&&n.nrm(0,"div",16)}function w(t,i){if(1&t){const o=n.RV6();n.j41(0,"div",3)(1,"div",4),n.EFF(2),n.k0s(),n.j41(3,"div",5),n.EFF(4),n.k0s(),n.j41(5,"div",6)(6,"div",7),n.nrm(7,"ion-icon",8),n.EFF(8),n.nI1(9,"date"),n.k0s(),n.j41(10,"div",7),n.nrm(11,"ion-icon",8),n.EFF(12),n.nI1(13,"date"),n.k0s()(),n.DNE(14,F,5,2,"div",9),n.j41(15,"div",10)(16,"ion-button",11),n.bIt("click",function(){const a=n.eBV(o).$implicit,l=n.XpG();return n.Njj(l.reemprestarLivro(a))}),n.EFF(17),n.k0s()(),n.DNE(18,E,1,0,"div",12),n.k0s()}if(2&t){const o=i.$implicit,e=i.last;n.R7$(2),n.JRh(o.book.titulo),n.R7$(2),n.JRh(o.book.autor),n.R7$(4),n.SpI(" Emprestado: ",n.i5U(9,8,o.dataEmprestimo,"dd/MM/yyyy")," "),n.R7$(4),n.SpI(" Devolvido: ",n.i5U(13,11,o.dataDevolucaoReal,"dd/MM/yyyy")," "),n.R7$(2),n.Y8G("ngIf",o.multaCalculada>0),n.R7$(2),n.Y8G("disabled",0===o.book.quantidade),n.R7$(),n.SpI(" ",o.book.quantidade>0?"Emprestar Novamente":"Indispon\xedvel"," "),n.R7$(),n.Y8G("ngIf",!e)}}let I=(()=>{var t;class i{constructor(e,a,l,s){this.loanRepository=e,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(e=>{e instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getReturnedLoansByUserId(1)}reemprestarLivro(e){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Novo Empr\xe9stimo",message:`\n      Tem certeza que deseja alugar o livro "${e.book.titulo}" novamente?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{if(e.book.quantidade>0){const s=new O.F(e.book,e.user,new Date,new Date(Date.now()+12096e5));e.book.quantidade--,a.bookRepository.update(e.book.id,e.book),a.loanRepository.add(s),a.reloadData()}else a.alertController.create({header:"Livro Indispon\xedvel",message:"Este livro n\xe3o est\xe1 dispon\xedvel no momento.",buttons:["OK"]}).then(s=>s.present())}}]})).present()})()}}return(t=i).\u0275fac=function(e){return new(e||t)(n.rXU(C.d),n.rXU(h.U),n.rXU(m.Ix),n.rXU(r.hG))},t.\u0275cmp=n.VBU({type:t,selectors:[["app-returned-loans"]],decls:7,vars:1,consts:[[1,"returned-loans-card"],[1,"loans-container"],["class","loan-item",4,"ngFor","ngForOf"],[1,"loan-item"],[1,"book-title"],[1,"book-author"],[1,"loan-dates"],[1,"date-item"],["name","calendar-outline",1,"date-icon"],["class","fine-container",4,"ngIf"],[1,"actions-container"],["size","small","color","primary","fill","solid",1,"action-button",3,"click","disabled"],["class","divider",4,"ngIf"],[1,"fine-container"],[1,"fine-badge"],[1,"fine-status"],[1,"divider"]],template:function(e,a){1&e&&(n.j41(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-title"),n.EFF(3,"Hist\xf3rico de Empr\xe9stimos"),n.k0s()(),n.j41(4,"ion-card-content")(5,"div",1),n.DNE(6,w,19,14,"div",2),n.k0s()()()),2&e&&(n.R7$(6),n.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,d.Sq,d.bT,d.MD,d.vh],styles:[".returned-loans-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.loans-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.loan-item[_ngcontent-%COMP%]{padding:12px;border-radius:8px}.book-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.book-author[_ngcontent-%COMP%]{color:#666;font-size:.95em;margin-bottom:12px}.loan-dates[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin:12px 0}.date-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.95em}.date-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:1.2em}.fine-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin:12px 0}.fine-badge[_ngcontent-%COMP%]{background:#e53935;color:#fff;border-radius:8px;padding:4px 12px;font-size:.95em;display:inline-block}.fine-status[_ngcontent-%COMP%]{color:#4caf50;font-weight:500}.actions-container[_ngcontent-%COMP%]{margin-top:12px}.action-button[_ngcontent-%COMP%]{width:100%}.divider[_ngcontent-%COMP%]{height:12px}@media (max-width: 414px){.returned-loans-card[_ngcontent-%COMP%]{margin:8px;width:calc(100% - 16px)}.loan-item[_ngcontent-%COMP%]{padding:8px}.book-title[_ngcontent-%COMP%]{font-size:1em}.book-author[_ngcontent-%COMP%], .date-item[_ngcontent-%COMP%]{font-size:.9em}.fine-badge[_ngcontent-%COMP%]{font-size:.9em;padding:3px 10px}.fine-status[_ngcontent-%COMP%]{font-size:.9em}}"]}),i})();function j(t,i){1&t&&n.nrm(0,"app-loans")}function $(t,i){1&t&&n.nrm(0,"app-returned-loans")}let x=(()=>{var t;class i{constructor(){this.selectedSegment="active"}ngOnInit(){}segmentChanged(e){this.selectedSegment=e.detail.value}}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.VBU({type:t,selectors:[["app-select-loans"]],decls:10,vars:4,consts:[[3,"ngModelChange","ionChange","ngModel"],["value","active"],["value","returned"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(e,a){1&e&&(n.j41(0,"ion-segment",0),n.mxI("ngModelChange",function(s){return n.DH7(a.selectedSegment,s)||(a.selectedSegment=s),s}),n.bIt("ionChange",function(s){return a.segmentChanged(s)}),n.j41(1,"ion-segment-button",1)(2,"ion-label"),n.EFF(3,"Empr\xe9stimos Ativos"),n.k0s()(),n.j41(4,"ion-segment-button",2)(5,"ion-label"),n.EFF(6,"Empr\xe9stimos Devolvidos"),n.k0s()()(),n.j41(7,"div",3),n.DNE(8,j,1,0,"app-loans",4)(9,$,1,0,"app-returned-loans",4),n.k0s()),2&e&&(n.R50("ngModel",a.selectedSegment),n.R7$(7),n.Y8G("ngSwitch",a.selectedSegment),n.R7$(),n.Y8G("ngSwitchCase","active"),n.R7$(),n.Y8G("ngSwitchCase","returned"))},dependencies:[r.bv,r.he,r.Gp,r.eP,r.Je,k,I,p.YN,p.BC,p.vS,d.MD,d.ux,d.e1],styles:["ion-segment[_ngcontent-%COMP%]{margin:16px 0}ion-segment-button[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--color-checked: var(--ion-color-primary);--indicator-color: var(--ion-color-primary)}"]}),i})();const D=[{path:"",component:(()=>{var t;class i{constructor(){}ngOnInit(){}}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.VBU({type:t,selectors:[["app-profile"]],standalone:!1,decls:4,vars:0,consts:[[1,"container"],[1,"cards"]],template:function(e,a){1&e&&(n.j41(0,"div",0)(1,"div",1),n.nrm(2,"app-card")(3,"app-select-loans"),n.k0s()())},dependencies:[_,x],styles:[".container[_ngcontent-%COMP%]{width:100%;max-width:414px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:16px;min-height:100vh}.cards[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding:16px;min-height:0}"]}),i})()}];let L=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.$C({type:t}),t.\u0275inj=n.G2t({imports:[f.iI.forChild(D),f.iI]}),i})(),S=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.$C({type:t}),t.\u0275inj=n.G2t({imports:[d.MD,p.YN,r.bv,L,_,x]}),i})()}}]);