"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2683],{2683:(T,g,c)=>{c.r(g),c.d(g,{ProfilePageModule:()=>S});var d=c(2881),p=c(4341),r=c(9420),f=c(5207),e=c(1360),v=c(1633);let _=(()=>{var n;class i{constructor(t){this.userRepository=t,this.user=void 0,this.user=t.getById(1)}ngOnInit(){}}return(n=i).\u0275fac=function(t){return new(t||n)(e.rXU(v.G))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-card"]],features:[e.Jv_([v.G])],decls:15,vars:3,consts:[[1,"profile-card"],[1,"profile-info"],[1,"profile-avatar"],["name","person-circle",1,"avatar-icon"],[1,"user-details"],[1,"user-name"],[1,"user-email"],[1,"course-name"]],template:function(t,a){1&t&&(e.j41(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Meu Perfil"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div",1)(6,"ion-avatar",2),e.nrm(7,"ion-icon",3),e.k0s(),e.j41(8,"div",4)(9,"div",5),e.EFF(10),e.k0s(),e.j41(11,"div",6),e.EFF(12),e.k0s(),e.j41(13,"span",7),e.EFF(14),e.k0s()()()()()),2&t&&(e.R7$(10),e.JRh(null==a.user?null:a.user.nome),e.R7$(2),e.JRh(null==a.user?null:a.user.email),e.R7$(2),e.JRh(null==a.user?null:a.user.curso))},dependencies:[r.bv,r.mC,r.b_,r.I9,r.ME,r.tN,r.iq],styles:[".profile-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.profile-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:12px;flex-wrap:wrap}@media (max-width: 480px){.profile-info[_ngcontent-%COMP%]{justify-content:center;text-align:center}}.profile-avatar[_ngcontent-%COMP%]{width:56px;height:56px;min-width:56px}.avatar-icon[_ngcontent-%COMP%]{font-size:56px;color:#1976d2}.user-details[_ngcontent-%COMP%]{flex:1;min-width:200px}@media (max-width: 480px){.user-details[_ngcontent-%COMP%]{width:100%}}.user-name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.user-email[_ngcontent-%COMP%]{font-size:.95em;color:#888}.course-name[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}"]}),i})();var u=c(467),m=c(9609),h=c(8806),C=c(9368);function b(n,i){if(1&n&&(e.j41(0,"div",15)(1,"span",16),e.EFF(2),e.k0s(),e.j41(3,"span",17),e.EFF(4),e.k0s()()),2&n){const o=e.XpG().$implicit;e.R7$(2),e.SpI(" Atrasado (",o.multa," dias) "),e.R7$(2),e.SpI(" Multa: R$",o.multa,",00 ")}}function y(n,i){if(1&n&&(e.j41(0,"span",18),e.EFF(1),e.k0s()),2&n){const o=e.XpG().$implicit,t=e.XpG();e.R7$(),e.SpI(" ",t.diasRestantes(o)," dias restantes ")}}function M(n,i){if(1&n){const o=e.RV6();e.j41(0,"ion-button",19),e.bIt("click",function(){e.eBV(o);const a=e.XpG().$implicit,l=e.XpG();return e.Njj(l.renovarEmprestimo(a))}),e.EFF(1,"Renovar"),e.k0s()}}function R(n,i){1&n&&e.nrm(0,"div",20)}function P(n,i){if(1&n){const o=e.RV6();e.j41(0,"div",4)(1,"div",5),e.EFF(2),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s(),e.j41(5,"div",7)(6,"div",8),e.nrm(7,"ion-icon",9),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.j41(10,"div",8),e.nrm(11,"ion-icon",9),e.EFF(12),e.nI1(13,"date"),e.k0s()(),e.DNE(14,b,5,2,"div",10)(15,y,2,1,"ng-template",null,0,e.C5r),e.j41(17,"div",11),e.DNE(18,M,2,0,"ion-button",12),e.j41(19,"ion-button",13),e.bIt("click",function(){const a=e.eBV(o).$implicit,l=e.XpG();return e.Njj(l.devolverLivro(a))}),e.EFF(20,"Devolver"),e.k0s()(),e.DNE(21,R,1,0,"div",14),e.k0s()}if(2&n){const o=i.$implicit,t=i.last,a=e.sdS(16);e.R7$(2),e.JRh(o.book.titulo),e.R7$(2),e.JRh(o.book.autor),e.R7$(4),e.SpI(" Emprestado: ",e.i5U(9,8,o.dataEmprestimo,"dd/MM/yyyy")," "),e.R7$(4),e.SpI(" Devolu\xe7\xe3o: ",e.i5U(13,11,o.dataDevolucao,"dd/MM/yyyy")," "),e.R7$(2),e.Y8G("ngIf",o.multa>0)("ngIfElse",a),e.R7$(4),e.Y8G("ngIf",0===o.multa),e.R7$(3),e.Y8G("ngIf",!t)}}let F=(()=>{var n;class i{constructor(t,a,l,s){this.loanRepository=t,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(t=>{t instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getActiveLoansByUserId(1)}diasRestantes(t){const a=new Date,l=t.dataDevolucao.getTime()-a.getTime();return Math.max(Math.ceil(l/864e5),0)}renovarEmprestimo(t){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Renova\xe7\xe3o",message:`\n      Tem certeza que deseja renovar o empr\xe9stimo do livro "${t.book.titulo}" por mais 7 dias?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{t.dataEmprestimo=new Date(t.dataEmprestimo.getTime()+6048e5),t.dataDevolucao=new Date(t.dataDevolucao.getTime()+6048e5),a.loanRepository.update(t.id,t),a.reloadData()}}]})).present()})()}devolverLivro(t){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Devolu\xe7\xe3o",message:`\n      Tem certeza que deseja devolver o livro "${t.book.titulo}"?\n      ${t.multa>0?`\n\nMulta pendente: R$${t.multa},00`:""}\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{a.loanRepository.devolverLivro(t.id);const s=t.book;s.quantidade++,a.bookRepository.update(s.id,s),a.reloadData()}}]})).present()})()}}return(n=i).\u0275fac=function(t){return new(t||n)(e.rXU(h.d),e.rXU(C.U),e.rXU(m.Ix),e.rXU(r.hG))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-loans"]],decls:7,vars:1,consts:[["prazoRestante",""],[1,"loans-card"],[1,"loans-container"],["class","loan-item",4,"ngFor","ngForOf"],[1,"loan-item"],[1,"book-title"],[1,"book-author"],[1,"loan-dates"],[1,"date-item"],["name","calendar-outline",1,"date-icon"],["class","status-container",4,"ngIf","ngIfElse"],[1,"actions-container"],["size","small","color","primary","fill","solid","class","action-button",3,"click",4,"ngIf"],["size","small","color","success","fill","solid",1,"action-button",3,"click"],["class","divider",4,"ngIf"],[1,"status-container"],[1,"status-badge","status-late"],[1,"fine-amount"],[1,"status-badge","status-remaining"],["size","small","color","primary","fill","solid",1,"action-button",3,"click"],[1,"divider"]],template:function(t,a){1&t&&(e.j41(0,"ion-card",1)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Meus Empr\xe9stimos"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div",2),e.DNE(6,P,22,14,"div",3),e.k0s()()()),2&t&&(e.R7$(6),e.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,d.Sq,d.bT,d.MD,d.vh],styles:[".loans-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.loans-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.loan-item[_ngcontent-%COMP%]{padding:12px;border-radius:8px}.book-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.book-author[_ngcontent-%COMP%]{color:#666;font-size:.95em;margin-bottom:12px}.loan-dates[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin:12px 0}.date-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.95em}.date-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:1.2em}.status-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin:12px 0}.status-badge[_ngcontent-%COMP%]{border-radius:8px;padding:4px 12px;font-size:.95em;display:inline-block}.status-late[_ngcontent-%COMP%]{background:#e53935;color:#fff}.status-remaining[_ngcontent-%COMP%]{background:#ffd600;color:#333}.fine-amount[_ngcontent-%COMP%]{color:#e53935;font-weight:700}.actions-container[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}.action-button[_ngcontent-%COMP%]{flex:1;min-width:120px}.divider[_ngcontent-%COMP%]{height:12px}@media (max-width: 414px){.loans-card[_ngcontent-%COMP%]{margin:8px;width:calc(100% - 16px)}.loan-item[_ngcontent-%COMP%]{padding:8px}.book-title[_ngcontent-%COMP%]{font-size:1em}.book-author[_ngcontent-%COMP%], .date-item[_ngcontent-%COMP%]{font-size:.9em}.status-badge[_ngcontent-%COMP%]{font-size:.9em;padding:3px 10px}.actions-container[_ngcontent-%COMP%]{flex-direction:column}.action-button[_ngcontent-%COMP%]{width:100%}}"]}),i})();var k=c(5572);function E(n,i){if(1&n&&(e.j41(0,"div")(1,"span",10),e.EFF(2),e.k0s(),e.j41(3,"span",11),e.EFF(4),e.k0s()()),2&n){const o=e.XpG().$implicit;e.R7$(2),e.SpI(" Multa: R$",o.multaCalculada,",00 "),e.R7$(2),e.SpI(" ",o.multaPaga?"Pago":"Pendente"," ")}}function I(n,i){1&n&&e.nrm(0,"div",12)}function O(n,i){if(1&n){const o=e.RV6();e.j41(0,"div",1)(1,"div",2),e.EFF(2),e.k0s(),e.j41(3,"div",3),e.EFF(4),e.k0s(),e.j41(5,"div",4),e.nrm(6,"ion-icon",5),e.EFF(7),e.nI1(8,"date"),e.nrm(9,"br")(10,"ion-icon",5),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.DNE(13,E,5,2,"div",6),e.j41(14,"div",7)(15,"ion-button",8),e.bIt("click",function(){const a=e.eBV(o).$implicit,l=e.XpG();return e.Njj(l.reemprestarLivro(a))}),e.EFF(16),e.k0s()(),e.DNE(17,I,1,0,"div",9),e.k0s()}if(2&n){const o=i.$implicit,t=i.last;e.R7$(2),e.JRh(o.book.titulo),e.R7$(2),e.JRh(o.book.autor),e.R7$(3),e.SpI(" Emprestado: ",e.i5U(8,8,o.dataEmprestimo,"dd/MM/yyyy")," "),e.R7$(4),e.SpI(" Devolvido: ",e.i5U(12,11,o.dataDevolucaoReal,"dd/MM/yyyy")," "),e.R7$(2),e.Y8G("ngIf",o.multaCalculada>0),e.R7$(2),e.Y8G("disabled",0===o.book.quantidade),e.R7$(),e.SpI(" ",o.book.quantidade>0?"Emprestar Novamente":"Indispon\xedvel"," "),e.R7$(),e.Y8G("ngIf",!t)}}let $=(()=>{var n;class i{constructor(t,a,l,s){this.loanRepository=t,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(t=>{t instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getReturnedLoansByUserId(1)}reemprestarLivro(t){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Novo Empr\xe9stimo",message:`\n      Tem certeza que deseja alugar o livro "${t.book.titulo}" novamente?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{if(t.book.quantidade>0){const s=new k.F(t.book,t.user,new Date,new Date(Date.now()+12096e5));t.book.quantidade--,a.bookRepository.update(t.book.id,t.book),a.loanRepository.add(s),a.reloadData()}else a.alertController.create({header:"Livro Indispon\xedvel",message:"Este livro n\xe3o est\xe1 dispon\xedvel no momento.",buttons:["OK"]}).then(s=>s.present())}}]})).present()})()}}return(n=i).\u0275fac=function(t){return new(t||n)(e.rXU(h.d),e.rXU(C.U),e.rXU(m.Ix),e.rXU(r.hG))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-returned-loans"]],decls:7,vars:1,consts:[["class","loan-card","style","margin-bottom: 16px;",4,"ngFor","ngForOf"],[1,"loan-card",2,"margin-bottom","16px"],[2,"font-weight","bold"],[2,"color","#666"],[2,"margin","8px 0"],["name","calendar-outline",2,"color","#1976d2","font-size","1em"],[4,"ngIf"],[2,"margin-top","8px"],["size","small","color","primary","fill","solid",3,"click","disabled"],["style","height: 12px;",4,"ngIf"],[2,"background","#e53935","color","#fff","border-radius","8px","padding","2px 10px","font-size","0.95em"],[2,"color","#4caf50","margin-left","8px"],[2,"height","12px"]],template:function(t,a){1&t&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Hist\xf3rico de Empr\xe9stimos"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div"),e.DNE(6,O,18,14,"div",0),e.k0s()()()),2&t&&(e.R7$(6),e.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,d.Sq,d.bT,d.MD,d.vh],encapsulation:2}),i})();function j(n,i){1&n&&e.nrm(0,"app-loans")}function D(n,i){1&n&&e.nrm(0,"app-returned-loans")}let x=(()=>{var n;class i{constructor(){this.selectedSegment="active"}ngOnInit(){}segmentChanged(t){this.selectedSegment=t.detail.value}}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-select-loans"]],decls:10,vars:4,consts:[[3,"ngModelChange","ionChange","ngModel"],["value","active"],["value","returned"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(t,a){1&t&&(e.j41(0,"ion-segment",0),e.mxI("ngModelChange",function(s){return e.DH7(a.selectedSegment,s)||(a.selectedSegment=s),s}),e.bIt("ionChange",function(s){return a.segmentChanged(s)}),e.j41(1,"ion-segment-button",1)(2,"ion-label"),e.EFF(3,"Empr\xe9stimos Ativos"),e.k0s()(),e.j41(4,"ion-segment-button",2)(5,"ion-label"),e.EFF(6,"Empr\xe9stimos Devolvidos"),e.k0s()()(),e.j41(7,"div",3),e.DNE(8,j,1,0,"app-loans",4)(9,D,1,0,"app-returned-loans",4),e.k0s()),2&t&&(e.R50("ngModel",a.selectedSegment),e.R7$(7),e.Y8G("ngSwitch",a.selectedSegment),e.R7$(),e.Y8G("ngSwitchCase","active"),e.R7$(),e.Y8G("ngSwitchCase","returned"))},dependencies:[r.bv,r.he,r.Gp,r.eP,r.Je,F,$,p.YN,p.BC,p.vS,d.MD,d.ux,d.e1],styles:["ion-segment[_ngcontent-%COMP%]{margin:16px 0}ion-segment-button[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--color-checked: var(--ion-color-primary);--indicator-color: var(--ion-color-primary)}"]}),i})();const w=[{path:"",component:(()=>{var n;class i{constructor(){}ngOnInit(){}}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-profile"]],standalone:!1,decls:4,vars:0,consts:[[1,"container"],[1,"cards"]],template:function(t,a){1&t&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"app-card")(3,"app-select-loans"),e.k0s()())},dependencies:[_,x],styles:[".container[_ngcontent-%COMP%]{width:100%;max-width:414px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:16px;min-height:100vh}.cards[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding:16px;min-height:0}"]}),i})()}];let L=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[f.iI.forChild(w),f.iI]}),i})(),S=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[d.MD,p.YN,r.bv,L,_,x]}),i})()}}]);