"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2683],{2683:(G,f,d)=>{d.r(f),d.d(f,{ProfilePageModule:()=>w});var c=d(2881),p=d(4341),r=d(9420),g=d(5207),e=d(1360),v=d(1633);let h=(()=>{var t;class i{constructor(o){this.userRepository=o,this.user=void 0,this.user=o.getById(1)}ngOnInit(){}}return(t=i).\u0275fac=function(o){return new(o||t)(e.rXU(v.G))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-card"]],features:[e.Jv_([v.G])],decls:15,vars:3,consts:[[1,"profile-card"],[1,"profile-info"],[1,"profile-avatar"],["name","person-circle",1,"avatar-icon"],[1,"user-details"],[1,"user-name"],[1,"user-email"],[1,"course-name"]],template:function(o,a){1&o&&(e.j41(0,"ion-card",0)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Meu Perfil"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div",1)(6,"ion-avatar",2),e.nrm(7,"ion-icon",3),e.k0s(),e.j41(8,"div",4)(9,"div",5),e.EFF(10),e.k0s(),e.j41(11,"div",6),e.EFF(12),e.k0s(),e.j41(13,"span",7),e.EFF(14),e.k0s()()()()()),2&o&&(e.R7$(10),e.JRh(null==a.user?null:a.user.nome),e.R7$(2),e.JRh(null==a.user?null:a.user.email),e.R7$(2),e.JRh(null==a.user?null:a.user.curso))},dependencies:[r.bv,r.mC,r.b_,r.I9,r.ME,r.tN,r.iq],styles:[".profile-card[_ngcontent-%COMP%]{width:calc(100% - 32px);max-width:600px;margin:16px auto}.profile-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:12px;flex-wrap:wrap}@media (max-width: 480px){.profile-info[_ngcontent-%COMP%]{justify-content:center;text-align:center}}.profile-avatar[_ngcontent-%COMP%]{width:56px;height:56px;min-width:56px}.avatar-icon[_ngcontent-%COMP%]{font-size:56px;color:#1976d2}.user-details[_ngcontent-%COMP%]{flex:1;min-width:200px}@media (max-width: 480px){.user-details[_ngcontent-%COMP%]{width:100%}}.user-name[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em;margin-bottom:4px}.user-email[_ngcontent-%COMP%]{font-size:.95em;color:#888}.course-name[_ngcontent-%COMP%]{font-weight:500;color:#1976d2}"]}),i})();var u=d(467),m=d(9609),_=d(8806),C=d(9368);function R(t,i){if(1&t&&(e.j41(0,"div")(1,"span",12),e.EFF(2),e.k0s(),e.j41(3,"span",13),e.EFF(4),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(2),e.SpI(" Atrasado (",n.multa," dias) "),e.R7$(2),e.SpI(" Multa: R$",n.multa,",00 ")}}function x(t,i){if(1&t&&(e.j41(0,"span",14),e.EFF(1),e.k0s()),2&t){const n=e.XpG().$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.diasRestantes(n)," dias restantes ")}}function b(t,i){if(1&t){const n=e.RV6();e.j41(0,"ion-button",15),e.bIt("click",function(){e.eBV(n);const a=e.XpG().$implicit,l=e.XpG();return e.Njj(l.renovarEmprestimo(a))}),e.EFF(1,"Renovar"),e.k0s()}}function F(t,i){1&t&&e.nrm(0,"div",16)}function E(t,i){if(1&t){const n=e.RV6();e.j41(0,"div",2)(1,"div",3),e.EFF(2),e.k0s(),e.j41(3,"div",4),e.EFF(4),e.k0s(),e.j41(5,"div",5),e.nrm(6,"ion-icon",6),e.EFF(7),e.nI1(8,"date"),e.nrm(9,"br")(10,"ion-icon",6),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.DNE(13,R,5,2,"div",7)(14,x,2,1,"ng-template",null,0,e.C5r),e.j41(16,"div",8),e.DNE(17,b,2,0,"ion-button",9),e.j41(18,"ion-button",10),e.bIt("click",function(){const a=e.eBV(n).$implicit,l=e.XpG();return e.Njj(l.devolverLivro(a))}),e.EFF(19,"Devolver"),e.k0s()(),e.DNE(20,F,1,0,"div",11),e.k0s()}if(2&t){const n=i.$implicit,o=i.last,a=e.sdS(15);e.R7$(2),e.JRh(n.book.titulo),e.R7$(2),e.JRh(n.book.autor),e.R7$(3),e.SpI(" Emprestado: ",e.i5U(8,8,n.dataEmprestimo,"dd/MM/yyyy")," "),e.R7$(4),e.SpI(" Devolu\xe7\xe3o: ",e.i5U(12,11,n.dataDevolucao,"dd/MM/yyyy")," "),e.R7$(2),e.Y8G("ngIf",n.multa>0)("ngIfElse",a),e.R7$(4),e.Y8G("ngIf",0===n.multa),e.R7$(3),e.Y8G("ngIf",!o)}}let k=(()=>{var t;class i{constructor(o,a,l,s){this.loanRepository=o,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(o=>{o instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getActiveLoansByUserId(1)}diasRestantes(o){const a=new Date,l=o.dataDevolucao.getTime()-a.getTime();return Math.max(Math.ceil(l/864e5),0)}renovarEmprestimo(o){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Renova\xe7\xe3o",message:`\n      Tem certeza que deseja renovar o empr\xe9stimo do livro "${o.book.titulo}" por mais 7 dias?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{o.dataEmprestimo=new Date(o.dataEmprestimo.getTime()+6048e5),o.dataDevolucao=new Date(o.dataDevolucao.getTime()+6048e5),a.loanRepository.update(o.id,o),a.reloadData()}}]})).present()})()}devolverLivro(o){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Devolu\xe7\xe3o",message:`\n      Tem certeza que deseja devolver o livro "${o.book.titulo}"?\n      ${o.multa>0?`\n\nMulta pendente: R$${o.multa},00`:""}\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{a.loanRepository.devolverLivro(o.id);const s=o.book;s.quantidade++,a.bookRepository.update(s.id,s),a.reloadData()}}]})).present()})()}}return(t=i).\u0275fac=function(o){return new(o||t)(e.rXU(_.d),e.rXU(C.U),e.rXU(m.Ix),e.rXU(r.hG))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-loans"]],decls:7,vars:1,consts:[["prazoRestante",""],["class","loan-card","style","margin-bottom: 16px;",4,"ngFor","ngForOf"],[1,"loan-card",2,"margin-bottom","16px"],[2,"font-weight","bold"],[2,"color","#666"],[2,"margin","8px 0"],["name","calendar-outline",2,"color","#1976d2","font-size","1em"],[4,"ngIf","ngIfElse"],[2,"margin-top","8px","display","flex","gap","8px"],["size","small","color","primary","fill","solid",3,"click",4,"ngIf"],["size","small","color","success","fill","solid",3,"click"],["style","height: 12px;",4,"ngIf"],[2,"background","#e53935","color","#fff","border-radius","8px","padding","2px 10px","font-size","0.95em"],[2,"color","#e53935","font-weight","bold","margin-left","8px"],[2,"background","#ffd600","color","#333","border-radius","8px","padding","2px 10px","font-size","0.95em"],["size","small","color","primary","fill","solid",3,"click"],[2,"height","12px"]],template:function(o,a){1&o&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Meus Empr\xe9stimos"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div"),e.DNE(6,E,21,14,"div",1),e.k0s()()()),2&o&&(e.R7$(6),e.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,c.Sq,c.bT,c.MD,c.vh],encapsulation:2}),i})();var M=d(5572);function P(t,i){if(1&t&&(e.j41(0,"div")(1,"span",10),e.EFF(2),e.k0s(),e.j41(3,"span",11),e.EFF(4),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(2),e.SpI(" Multa: R$",n.multaCalculada,",00 "),e.R7$(2),e.SpI(" ",n.multaPaga?"Pago":"Pendente"," ")}}function I(t,i){1&t&&e.nrm(0,"div",12)}function $(t,i){if(1&t){const n=e.RV6();e.j41(0,"div",1)(1,"div",2),e.EFF(2),e.k0s(),e.j41(3,"div",3),e.EFF(4),e.k0s(),e.j41(5,"div",4),e.nrm(6,"ion-icon",5),e.EFF(7),e.nI1(8,"date"),e.nrm(9,"br")(10,"ion-icon",5),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.DNE(13,P,5,2,"div",6),e.j41(14,"div",7)(15,"ion-button",8),e.bIt("click",function(){const a=e.eBV(n).$implicit,l=e.XpG();return e.Njj(l.reemprestarLivro(a))}),e.EFF(16),e.k0s()(),e.DNE(17,I,1,0,"div",9),e.k0s()}if(2&t){const n=i.$implicit,o=i.last;e.R7$(2),e.JRh(n.book.titulo),e.R7$(2),e.JRh(n.book.autor),e.R7$(3),e.SpI(" Emprestado: ",e.i5U(8,8,n.dataEmprestimo,"dd/MM/yyyy")," "),e.R7$(4),e.SpI(" Devolvido: ",e.i5U(12,11,n.dataDevolucaoReal,"dd/MM/yyyy")," "),e.R7$(2),e.Y8G("ngIf",n.multaCalculada>0),e.R7$(2),e.Y8G("disabled",0===n.book.quantidade),e.R7$(),e.SpI(" ",n.book.quantidade>0?"Emprestar Novamente":"Indispon\xedvel"," "),e.R7$(),e.Y8G("ngIf",!o)}}let j=(()=>{var t;class i{constructor(o,a,l,s){this.loanRepository=o,this.bookRepository=a,this.router=l,this.alertController=s,this.loans=[]}ngOnInit(){this.reloadData(),this.router.events.subscribe(o=>{o instanceof m.wF&&"/profile"===this.router.url&&this.reloadData()})}reloadData(){this.loans=this.loanRepository.getReturnedLoansByUserId(1)}reemprestarLivro(o){var a=this;return(0,u.A)(function*(){yield(yield a.alertController.create({header:"Confirmar Novo Empr\xe9stimo",message:`\n      Tem certeza que deseja alugar o livro "${o.book.titulo}" novamente?\n      `,buttons:[{text:"Cancelar",role:"cancel"},{text:"Confirmar",handler:()=>{if(o.book.quantidade>0){const s=new M.F(o.book,o.user,new Date,new Date(Date.now()+12096e5));o.book.quantidade--,a.bookRepository.update(o.book.id,o.book),a.loanRepository.add(s),a.reloadData()}else a.alertController.create({header:"Livro Indispon\xedvel",message:"Este livro n\xe3o est\xe1 dispon\xedvel no momento.",buttons:["OK"]}).then(s=>s.present())}}]})).present()})()}}return(t=i).\u0275fac=function(o){return new(o||t)(e.rXU(_.d),e.rXU(C.U),e.rXU(m.Ix),e.rXU(r.hG))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-returned-loans"]],decls:7,vars:1,consts:[["class","loan-card","style","margin-bottom: 16px;",4,"ngFor","ngForOf"],[1,"loan-card",2,"margin-bottom","16px"],[2,"font-weight","bold"],[2,"color","#666"],[2,"margin","8px 0"],["name","calendar-outline",2,"color","#1976d2","font-size","1em"],[4,"ngIf"],[2,"margin-top","8px"],["size","small","color","primary","fill","solid",3,"click","disabled"],["style","height: 12px;",4,"ngIf"],[2,"background","#e53935","color","#fff","border-radius","8px","padding","2px 10px","font-size","0.95em"],[2,"color","#4caf50","margin-left","8px"],[2,"height","12px"]],template:function(o,a){1&o&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"Hist\xf3rico de Empr\xe9stimos"),e.k0s()(),e.j41(4,"ion-card-content")(5,"div"),e.DNE(6,$,18,14,"div",0),e.k0s()()()),2&o&&(e.R7$(6),e.Y8G("ngForOf",a.loans))},dependencies:[r.bv,r.Jm,r.b_,r.I9,r.ME,r.tN,r.iq,c.Sq,c.bT,c.MD,c.vh],encapsulation:2}),i})();function D(t,i){1&t&&e.nrm(0,"app-loans")}function L(t,i){1&t&&e.nrm(0,"app-returned-loans")}let y=(()=>{var t;class i{constructor(){this.selectedSegment="active"}ngOnInit(){}segmentChanged(o){this.selectedSegment=o.detail.value}}return(t=i).\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.VBU({type:t,selectors:[["app-select-loans"]],decls:10,vars:4,consts:[[3,"ngModelChange","ionChange","ngModel"],["value","active"],["value","returned"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(o,a){1&o&&(e.j41(0,"ion-segment",0),e.mxI("ngModelChange",function(s){return e.DH7(a.selectedSegment,s)||(a.selectedSegment=s),s}),e.bIt("ionChange",function(s){return a.segmentChanged(s)}),e.j41(1,"ion-segment-button",1)(2,"ion-label"),e.EFF(3,"Empr\xe9stimos Ativos"),e.k0s()(),e.j41(4,"ion-segment-button",2)(5,"ion-label"),e.EFF(6,"Empr\xe9stimos Devolvidos"),e.k0s()()(),e.j41(7,"div",3),e.DNE(8,D,1,0,"app-loans",4)(9,L,1,0,"app-returned-loans",4),e.k0s()),2&o&&(e.R50("ngModel",a.selectedSegment),e.R7$(7),e.Y8G("ngSwitch",a.selectedSegment),e.R7$(),e.Y8G("ngSwitchCase","active"),e.R7$(),e.Y8G("ngSwitchCase","returned"))},dependencies:[r.bv,r.he,r.Gp,r.eP,r.Je,k,j,p.YN,p.BC,p.vS,c.MD,c.ux,c.e1],styles:["ion-segment[_ngcontent-%COMP%]{margin:16px 0}ion-segment-button[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--color-checked: var(--ion-color-primary);--indicator-color: var(--ion-color-primary)}"]}),i})();const S=[{path:"",component:(()=>{var t;class i{constructor(){}ngOnInit(){}}return(t=i).\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.VBU({type:t,selectors:[["app-profile"]],standalone:!1,decls:4,vars:0,consts:[[1,"container"],[1,"cards"]],template:function(o,a){1&o&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"app-card")(3,"app-select-loans"),e.k0s()())},dependencies:[h,y],styles:[".container[_ngcontent-%COMP%]{width:100%;max-width:414px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:16px;min-height:100vh}.cards[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding:16px;min-height:0}"]}),i})()}];let T=(()=>{var t;class i{}return(t=i).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.iI.forChild(S),g.iI]}),i})(),w=(()=>{var t;class i{}return(t=i).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[c.MD,p.YN,r.bv,T,h,y]}),i})()}}]);